/* Spreadsheet Node Styles (Jspreadsheet CE v5 Overrides) */

/* Wrapper */
.node-spreadsheet {
    width: fit-content;
    height: fit-content;
    background: var(--bg-surface);
    color: var(--text-primary);
}

/* Overriding Jspreadsheet Variables/Styles */
.jss_container {
    font-family: inherit;
    background: var(--bg-surface);
    border: none;
    box-shadow: none;
}

/* Headers (A, B, C...) */
.jss_worksheet>thead>tr>td {
    background-color: var(--bg-surface-active) !important;
    color: var(--text-secondary) !important;
    border-color: var(--border-base) !important;
    font-size: 0.75rem;
    /* text-xs */
    font-weight: 600;
}

/* Row Numbers (1, 2, 3...) */
.jss_worksheet>tbody>tr>td:first-child {
    background-color: var(--bg-surface-active) !important;
    color: var(--text-secondary) !important;
    border-color: var(--border-base) !important;
    font-size: 0.75rem;
}

/* Cells */
.jss_worksheet>tbody>tr>td {
    background-color: var(--bg-surface);
    color: var(--text-primary);
    border-color: var(--border-base);
    padding: 4px;
    font-size: 0.875rem;
    /* text-sm */
}

/* Active Cell */
.jss_worksheet .highlight {
    background-color: color-mix(in srgb, var(--color-accent), transparent 90%) !important;
}

.jss_worksheet .highlight-selected {
    background-color: color-mix(in srgb, var(--color-accent), transparent 85%) !important;
}

/* The selected cell border/state */
.jss_worksheet>tbody>tr>td.active {
    border-color: var(--color-accent) !important;
    color: var(--text-primary);
    box-shadow: 0 0 0 1px var(--color-accent);
}

/* Inputs / Textareas */
.jss_content textarea,
.jss_content input {
    background: var(--bg-surface) !important;
    color: var(--text-primary) !important;
    font-family: inherit;
}

/* JSuites Context Menu */
.jcontextmenu {
    background: var(--bg-surface) !important;
    border: 1px solid var(--border-base) !important;
    box-shadow: var(--shadow-lg) !important;
    color: var(--text-primary) !important;
    border-radius: var(--radius-md) !important;
    z-index: 10001 !important;
}

.jcontextmenu>div {
    color: var(--text-primary) !important;
    padding: 8px 12px !important;
}

.jcontextmenu>div:hover {
    background: var(--bg-surface-hover) !important;
    color: var(--text-primary) !important;
}

/* Override ALL nested text elements in context menu */
.jcontextmenu>div>*,
.jcontextmenu>div>a,
.jcontextmenu>div>span,
.jcontextmenu a,
.jcontextmenu span {
    color: var(--text-primary) !important;
}

.jcontextmenu>div:hover>*,
.jcontextmenu>div:hover>a,
.jcontextmenu>div:hover>span {
    color: var(--text-primary) !important;
}

.jcontextmenu hr {
    border: none !important;
    border-bottom: 1px solid var(--border-base) !important;
    margin: 4px 0 !important;
}

/* Hide the 'Powered by' */
.jss_about {
    display: none !important;
}

/* ========================================
   ENHANCED DARK MODE OVERRIDES
   ======================================== */

/* Table Background */
.jss_worksheet {
    background-color: var(--bg-surface) !important;
    border-color: var(--border-base) !important;
}

/* All Cell Borders - Override hardcoded #ccc */
.jss_worksheet>thead>tr>td,
.jss_worksheet>tbody>tr>td,
.jss_worksheet>tfoot>tr>td {
    border-top-color: var(--border-base) !important;
    border-left-color: var(--border-base) !important;
    border-right-color: transparent !important;
    border-bottom-color: transparent !important;
}

/* Table outer borders */
.jss_worksheet {
    border-right-color: var(--border-base) !important;
    border-bottom-color: var(--border-base) !important;
}

/* Selection Highlighting - Make it VISIBLE (like TableNode focus) */
.jss_worksheet .highlight {
    background-color: var(--bg-surface-active) !important;
}

.jss_worksheet .highlight-selected {
    background-color: var(--bg-surface-hover) !important;
}

/* Selection Borders - Override black (#000) to accent color */
.jss_worksheet .highlight-top {
    border-top: 1px solid var(--color-accent) !important;
    box-shadow: none !important;
}

.jss_worksheet .highlight-left {
    border-left: 1px solid var(--color-accent) !important;
    box-shadow: none !important;
}

.jss_worksheet .highlight-right {
    border-right: 1px solid var(--color-accent) !important;
}

.jss_worksheet .highlight-bottom {
    border-bottom: 1px solid var(--color-accent) !important;
}

/* Selected Headers/Rows Background */
.jss_worksheet>thead>tr>td.selected {
    background-color: var(--bg-surface-hover) !important;
}

.jss_worksheet>tbody>tr.selected>td:first-child {
    background-color: var(--bg-surface-hover) !important;
}

/* Copy/Paste Selection Indicators */
.jss_worksheet .selection {
    background-color: var(--bg-surface-active) !important;
}

.jss_worksheet .selection-left,
.jss_worksheet .selection-right,
.jss_worksheet .selection-top,
.jss_worksheet .selection-bottom {
    border-color: var(--color-accent) !important;
}

/* Copying State Indicators */
.jss_worksheet .copying-top,
.jss_worksheet .copying-left,
.jss_worksheet .copying-right,
.jss_worksheet .copying-bottom {
    border-color: var(--color-accent) !important;
}

/* Corner Handle (Fill Handle) */
.jss_corner {
    background-color: var(--color-accent) !important;
    border-color: var(--bg-surface) !important;
}

/* Dropdown Elements */
.jdropdown-container,
.jdropdown-picker,
.jdropdown-header {
    background: var(--bg-surface) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-base) !important;
}

.jdropdown-item {
    color: var(--text-primary) !important;
}

.jdropdown-item:hover {
    background: var(--bg-surface-hover) !important;
}

/* Calendar Picker */
.jcalendar {
    background: var(--bg-surface) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-base) !important;
}

.jcalendar-header,
.jcalendar-week,
.jcalendar-content {
    background: var(--bg-surface) !important;
    color: var(--text-primary) !important;
}

.jcalendar-selected {
    background: var(--color-accent) !important;
    color: var(--color-accent-fg) !important;
}

/* Editor Containers */
.jss_worksheet .editor .jss_richtext,
.jss_worksheet .editor .jupload {
    background-color: var(--bg-surface) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-base) !important;
}

/* Fullscreen Mode */
.fullscreen {
    background-color: var(--bg-canvas) !important;
}

/* Scrollbar Styling for Dark Mode */
.jss_content::-webkit-scrollbar-track {
    background: var(--bg-surface-active) !important;
}

.jss_content::-webkit-scrollbar-thumb {
    background: var(--text-tertiary) !important;
}

.jss_content::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary) !important;
}

/* Pagination Elements */
.jss_pagination>div>div {
    border-color: var(--border-base) !important;
    color: var(--text-primary) !important;
}

.jss_page_selected {
    background-color: var(--bg-surface-active) !important;
    font-weight: 700;
}

/* Toolbar (if enabled) */
.jss_toolbar {
    background-color: var(--bg-surface-active) !important;
    border-color: var(--border-base) !important;
}

/* Resizing Indicators */
.jss_worksheet thead td.resizing,
.jss_worksheet tbody tr.resizing>td,
.jss_worksheet tbody td.resizing {
    border-color: var(--color-accent) !important;
}

/* Dragging State */
.jss_worksheet>thead>tr>td.dragging,
.jss_worksheet>tbody>tr.dragging>td {
    opacity: 0.5;
    background-color: var(--bg-surface-hover) !important;
}

/* Filter Row (if enabled) */
.jss_worksheet>thead>tr.jss_filter>td>input {
    background: var(--bg-surface) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-base) !important;
}